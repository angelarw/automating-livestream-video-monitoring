# build file for amplify console to deploy the frontend
version: 0.1
applications:
  - appRoot: /broadcast-monitoring-ui
    frontend:
      phases:
        preBuild:
          commands:
            # uncomment the below when the enc cache needs to be reset
            # (see https://github.com/aws-amplify/amplify-console/issues/138)
            #        - envCache --set stackInfo ""
#            - npm install -g @aws-amplify/cli@latest   # this is now done by the Amplify Console
            - amplify --version
            - pip install -r requirements.txt
            - python setup_config.py
            - amplifyPush --simple
            - cat src/aws-exports.js
            - npm ci
        build:
          commands:
            - npm run build
      artifacts:
        baseDirectory: dist
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
